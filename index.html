<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Love Note</title>
<style>
  :root{
    --pink:#ff6fbf;
    --bg:#0b0d10;
    --word-space:.28em;   /* ‚¨Ö increase/decrease to change space between words */
    --letter-space:.012em;/* ‚¨Ö tiny tracking for smoothness */
  }
  html,body{height:100%;margin:0}
  body{
    background:var(--bg); color:var(--pink);
    display:flex; align-items:center; justify-content:center;
    flex-direction:column; text-align:center;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    overflow:hidden; padding:6vh 6vw;
  }

  /* Main text block */
  .txt{
    font-size: clamp(18px, 4.5vw, 36px);
    line-height: 1.35;
    text-shadow: 0 0 .4em rgba(255,111,191,.55);
    max-width: 900px;
    word-spacing: var(--word-space);
    letter-spacing: var(--letter-space);
    z-index: 1;
  }

  /* Letter-by-letter pop */
  .ch{
    opacity:0; display:inline-block;
    transform: translateY(.15em) scale(.98);
    animation: pop .24s ease-out forwards;
  }
  @keyframes pop{
    60%{ opacity:1; transform: translateY(-.04em) scale(1.06); }
    100%{ opacity:1; transform: translateY(0)       scale(1); }
  }

  /* Caret */
  .caret{
    display:inline-block; width:.55ch; height:1em; vertical-align:-0.1em;
    border-right:.12em solid currentColor; margin-left:.06ch;
    animation:blink .9s step-end infinite;
  }
  @keyframes blink{50%{border-right-color:transparent}}

  /* Floating hearts / sparkles */
  .float{position:fixed; inset:0; pointer-events:none; z-index:0;}
  .float span{
    position:absolute; bottom:-10vh; font-size:24px; opacity:.9;
    animation:rise linear forwards;
    filter:drop-shadow(0 0 6px rgba(255,111,191,.6));
  }
  @keyframes rise{
    0%  {transform:translateY(0) translateX(0) rotate(0deg); opacity:0;}
    10% {opacity:1;}
    100%{transform:translateY(-120vh) translateX(var(--drift,0)) rotate(360deg); opacity:0;}
  }

  /* BIG finale overlay */
  #finale{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
    flex-direction:column; gap:2vh; z-index:5; pointer-events:none;
    opacity:0; transform:scale(.6);
  }
  /* Reveal ‚Üí heartbeat (3x) ‚Üí fade out */
  #finale.show{
    animation:
      reveal   1.2s cubic-bezier(.2,1,.2,1) 0s 1 forwards,
      heartbeat 2.5s ease-in-out            1.2s 3,
      fadeout  1.1s ease                    9s   1 forwards;
  }
  #finale .bg-glow{
    position:absolute; inset:-20vh; z-index:-1;
    background: radial-gradient(40% 40% at 50% 50%, rgba(255,111,191,.22), transparent 60%);
    filter: blur(32px);
  }
  #big-heart{
    font-size: clamp(140px, 40vw, 620px);   /* HUGE */
    text-shadow: 0 0 40px rgba(255,111,191,.7), 0 0 80px rgba(255,111,191,.35);
    line-height: 1;
  }
  #big-kiss{
    font-size: clamp(80px, 22vw, 380px);
    text-shadow: 0 0 30px rgba(255,111,191,.6), 0 0 60px rgba(255,111,191,.3);
    line-height: 1;
  }
  @keyframes reveal{
    0%{opacity:0; transform:scale(.6)}
    60%{opacity:1; transform:scale(1.12)}
    100%{opacity:1; transform:scale(1)}
  }
  @keyframes heartbeat{
    0%,100%{ transform:scale(1) }
    30%{ transform:scale(1.04) }
    60%{ transform:scale(1.01) }
  }
  @keyframes fadeout{
    to{ opacity:0; transform:scale(.98) }
  }

  /* Pink bloom flash on reveal */
  #bloom{
    position:fixed; inset:0; pointer-events:none; z-index:4;
    opacity:0; background: radial-gradient(closest-side, rgba(255,111,191,.45), transparent 70%);
  }
  #bloom.flash{ animation: bloom 0.6s ease-out forwards; }
  @keyframes bloom{
    0%  { opacity:0; transform:scale(.9); }
    35% { opacity:1; transform:scale(1); }
    100%{ opacity:0; transform:scale(1.15); }
  }

  /* Music pill */
  .pill{
    position:fixed; right:12px; bottom:12px; z-index:10;
    background:rgba(255,111,191,.15);
    border:1px solid rgba(255,111,191,.35);
    color:var(--pink); padding:.6rem .9rem; border-radius:999px;
    backdrop-filter:saturate(140%) blur(6px);
    font-weight:600; cursor:pointer; box-shadow:0 6px 18px rgba(0,0,0,.25);
  }
  .pill:hover{background:rgba(255,111,191,.25)}
  .hidden{display:none}
</style>

<div class="txt" id="out" aria-live="polite"></div>
<div class="caret" id="caret"></div>

<!-- BIG finale overlay -->
<div id="finale" aria-hidden="true">
  <div class="bg-glow"></div>
  <div id="big-heart">‚ù§Ô∏è</div>
</div>
<!-- Bloom flash layer -->
<div id="bloom"></div>

<div class="float" id="fx"></div>
<button id="music" class="pill hidden">Tap for music ‚ô™</button>

<script>
/* ========= 1) MESSAGE ========= */
const MESSAGE = `Holaaaaa bby ‚ù§Ô∏è

I just wanted to remind you
how much I love you.

Every little thing you do 
makes my day brighter,
and even when we're apart, 
you're always on my mind.

You mean so much to me,
and I‚Äôm so grateful to have you.

Love u always ü•∞

With all my heart,
M`;

const TYPING_SPEED_MS = 36;   // per-character speed
const PARAGRAPH_PAUSE_MS = 350;
const POP_RANDOM_JITTER = 90;

const out = document.getElementById('out');
const caret = document.getElementById('caret');
const finale = document.getElementById('finale');
const bloom  = document.getElementById('bloom');
let i = 0;

0;

function typeNext(){
  if(i >= MESSAGE.length){
    // Caret gone, then show big finale + bloom
    caret.remove();
    setTimeout(()=>{
      finale.classList.add('show');
      bloom.classList.add('flash');
      burstHearts(); // bigger floating hearts burst
      // remove bloom element after animation ends (cleanup)
      setTimeout(()=>{ bloom.classList.remove('flash'); }, 700);
    }, 600);
    return;
  }
  const ch = MESSAGE[i++];
  appendChar(ch);
  const delay = (ch === '\n') ? PARAGRAPH_PAUSE_MS : TYPING_SPEED_MS;
  setTimeout(typeNext, delay);
}
setTimeout(typeNext, 500);

/* ========= 2) FLOATING HEARTS & SPARKLES ========= */
(function(){
  const fx = document.getElementById('fx');
  const SYMS = ['üíñ','‚ú®','üíó','üíû'];
  function spawn(sizeMul=1){
    const s = document.createElement('span');
    s.textContent = SYMS[Math.floor(Math.random()*SYMS.length)];
    s.style.left = (Math.random()*100) + 'vw';
    s.style.fontSize = ((18 + Math.random()*26) * sizeMul) + 'px';
    s.style.setProperty('--drift', (Math.random()*80 - 40) + 'px');
    s.style.animationDuration = (5 + Math.random()*5) + 's';
    fx.appendChild(s);
    s.addEventListener('animationend', ()=> s.remove());
  }
  // gentle stream
  for(let k=0;k<18;k++) setTimeout(()=>spawn(1), k*120);
  setInterval(()=>spawn(1), 400);

  // finale burst (bigger)
  window.burstHearts = function(){
    for(let j=0;j<24;j++) setTimeout(()=>spawn(1.8), j*70);
  }
})();

/* ========= 3) SOFT INSTRUMENTAL MUSIC ========= */
(function(){
  let ctx, master, on = false, timer;
  const btn = document.getElementById('music');
  const chords = [
    [261.63, 329.63, 392.00, 493.88], // Cmaj7
    [220.00, 261.63, 329.63, 440.00], // Am7
    [174.61, 220.00, 261.63, 349.23], // Fmaj7
    [196.00, 246.94, 392.00, 493.88]  // G-ish
  ];

  function playChord(chord){
    const now = ctx.currentTime;
    chord.forEach((f)=>{
      const o = ctx.createOscillator();
      const g = ctx.createGain();
      o.type='sine'; o.frequency.value=f; o.detune.value=(-6+Math.random()*12);
      g.gain.setValueAtTime(0.0, now);
      g.gain.linearRampToValueAtTime(0.04/chord.length, now + 1.5);
      g.gain.linearRampToValueAtTime(0.0, now + 6.0);
      o.connect(g); g.connect(master);
      o.start(now); o.stop(now + 6.2);
    });
  }

  async function startAudio(){
    if(on) return;
    ctx = ctx || new (window.AudioContext||window.webkitAudioContext)();
    master = master || ctx.createGain();
    master.gain.value=0.0001;
    master.connect(ctx.destination);
    try{ await ctx.resume(); }catch(e){}
    master.gain.exponentialRampToValueAtTime(0.05, ctx.currentTime+3);
    let i=0; function tick(){ playChord(chords[i++%chords.length]); }
    tick(); timer=setInterval(tick,6000); on=true;
  }

  function stopAudio(){
    if(!on) return;
    clearInterval(timer);
    if(master) master.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+1);
    on=false;
  }

  document.addEventListener('DOMContentLoaded', async ()=>{
    try{
      await startAudio();
      if(!ctx || ctx.state!=='running') btn.classList.remove('hidden');
    }catch(e){ btn.classList.remove('hidden'); }
  });

  btn.addEventListener('click', async ()=>{
    if(!on){ await startAudio(); btn.textContent='Music on ‚ô™'; btn.classList.add('hidden'); }
    else { stopAudio(); btn.textContent='Tap for music ‚ô™'; }
  });
})();
</script>


